#\!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üîí Executando verifica√ß√µes de seguran√ßa..."

# Verifica se h√° secrets no c√≥digo
echo "Verificando secrets..."
if git diff --cached --name-only | xargs grep -E "(password|secret|key|token|apikey|api_key)" --ignore-case 2>/dev/null; then
  echo "‚ö†Ô∏è ATEN√á√ÉO: Poss√≠veis secrets detectados no c√≥digo\!"
  echo "Verifique os arquivos acima antes de commitar."
fi

# Verifica se .env est√° sendo commitado
if git diff --cached --name-only | grep -E "^\.env$"; then
  echo "‚ùå ERRO CR√çTICO: Tentativa de commitar arquivo .env\!"
  echo "Remova o .env do commit: git rm --cached .env"
  exit 1
fi

# Roda lint-staged
npx lint-staged

echo "‚úÖ Verifica√ß√µes de seguran√ßa conclu√≠das\!"
