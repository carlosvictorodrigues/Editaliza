<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Integração Notificações Inteligentes</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto p-8">
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-4 text-center">
                🎯 Teste de Integração - Notificações Inteligentes
            </h1>
            <p class="text-gray-600 text-center mb-8">
                Verificando se o sistema de notificações está integrado corretamente com a aplicação principal.
            </p>
        </div>

        <!-- Status do Sistema -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4 text-blue-800">🔔 Status do Sistema</h3>
                <div id="system-status" class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span>ContextualNotifications:</span>
                        <span id="contextual-status" class="px-2 py-1 rounded text-sm">Verificando...</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span>NotificationIntegrations:</span>
                        <span id="integrations-status" class="px-2 py-1 rounded text-sm">Verificando...</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span>App Integration:</span>
                        <span id="app-status" class="px-2 py-1 rounded text-sm">Verificando...</span>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4 text-green-800">🎯 Testes Rápidos</h3>
                <div class="space-y-3">
                    <button onclick="testWelcomeMessage()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Teste Mensagem de Boas-vindas
                    </button>
                    <button onclick="testSessionComplete()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Teste Conclusão de Sessão
                    </button>
                    <button onclick="testAchievement()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Teste Conquista
                    </button>
                </div>
            </div>
        </div>

        <!-- Logs -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-xl font-semibold mb-4 text-gray-800">📊 Logs do Sistema</h3>
            <div id="logs" class="bg-gray-100 rounded-lg p-4 h-64 overflow-y-auto font-mono text-sm">
                <div class="text-gray-500">Aguardando logs...</div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/app.js"></script>
    <script src="js/modules/contextual-notifications.js"></script>
    <script src="js/modules/notification-integrations.js"></script>
    
    <script>
        // Função para adicionar logs
        function addLog(message, type = 'info') {
            const logs = document.getElementById('logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `mb-1 ${type === 'error' ? 'text-red-600' : type === 'success' ? 'text-green-600' : 'text-gray-700'}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            logs.appendChild(logEntry);
            logs.scrollTop = logs.scrollHeight;
        }

        // Verificar status do sistema
        function checkSystemStatus() {
            addLog('🔍 Verificando status do sistema...');
            
            // Verificar ContextualNotifications
            const contextualStatus = document.getElementById('contextual-status');
            if (window.ContextualNotifications) {
                contextualStatus.textContent = '✅ Carregado';
                contextualStatus.className = 'px-2 py-1 rounded text-sm bg-green-100 text-green-800';
                addLog('✅ ContextualNotifications carregado com sucesso');
            } else {
                contextualStatus.textContent = '❌ Não carregado';
                contextualStatus.className = 'px-2 py-1 rounded text-sm bg-red-100 text-red-800';
                addLog('❌ ContextualNotifications não encontrado', 'error');
            }

            // Verificar NotificationIntegrations
            const integrationsStatus = document.getElementById('integrations-status');
            if (window.NotificationIntegrations) {
                integrationsStatus.textContent = '✅ Carregado';
                integrationsStatus.className = 'px-2 py-1 rounded text-sm bg-green-100 text-green-800';
                addLog('✅ NotificationIntegrations carregado com sucesso');
            } else {
                integrationsStatus.textContent = '❌ Não carregado';
                integrationsStatus.className = 'px-2 py-1 rounded text-sm bg-red-100 text-red-800';
                addLog('❌ NotificationIntegrations não encontrado', 'error');
            }

            // Verificar integração com app
            const appStatus = document.getElementById('app-status');
            if (window.app && window.app.config && window.app.config.notifications) {
                appStatus.textContent = '✅ Integrado';
                appStatus.className = 'px-2 py-1 rounded text-sm bg-green-100 text-green-800';
                addLog('✅ Sistema integrado com app.js');
            } else {
                appStatus.textContent = '❌ Não integrado';
                appStatus.className = 'px-2 py-1 rounded text-sm bg-red-100 text-red-800';
                addLog('❌ Sistema não integrado com app.js', 'error');
            }
        }

        // Teste de mensagem de boas-vindas
        function testWelcomeMessage() {
            addLog('🎯 Testando mensagem de boas-vindas...');
            if (window.ContextualNotifications) {
                window.ContextualNotifications.showWelcomeMessage();
                addLog('✅ Mensagem de boas-vindas enviada', 'success');
            } else {
                addLog('❌ ContextualNotifications não disponível', 'error');
            }
        }

        // Teste de conclusão de sessão
        function testSessionComplete() {
            addLog('🎯 Testando conclusão de sessão...');
            if (window.ContextualNotifications) {
                const sessionData = {
                    sessionType: 'Estudo',
                    duration: 25,
                    subject: 'Direito Constitucional',
                    difficulty: 3
                };
                window.ContextualNotifications.handleSessionCompleted(sessionData);
                addLog('✅ Evento de conclusão de sessão disparado', 'success');
            } else {
                addLog('❌ ContextualNotifications não disponível', 'error');
            }
        }

        // Teste de conquista
        function testAchievement() {
            addLog('🎯 Testando conquista...');
            if (window.ContextualNotifications) {
                const achievement = {
                    title: 'Primeira Sessão',
                    description: 'Completou sua primeira sessão de estudo!',
                    type: 'achievement'
                };
                window.ContextualNotifications.handleAchievement(achievement);
                addLog('✅ Evento de conquista disparado', 'success');
            } else {
                addLog('❌ ContextualNotifications não disponível', 'error');
            }
        }

        // Inicializar quando DOM estiver pronto
        document.addEventListener('DOMContentLoaded', () => {
            addLog('🚀 Página carregada, iniciando testes...');
            
            // Aguardar um pouco para os módulos carregarem
            setTimeout(() => {
                checkSystemStatus();
                
                // Verificar novamente após 3 segundos
                setTimeout(() => {
                    addLog('🔄 Verificação final do sistema...');
                    checkSystemStatus();
                }, 3000);
            }, 1000);
        });
    </script>
</body>
</html>
