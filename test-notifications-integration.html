<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Integra√ß√£o de Notifica√ß√µes Inteligentes</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <div class="container mx-auto p-8">
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-4 text-center">
                üéØ Teste de Integra√ß√£o - Sistema de Notifica√ß√µes Inteligentes
            </h1>
            <p class="text-gray-600 text-center mb-8">
                Teste da corre√ß√£o aplicada no sistema de notifica√ß√µes contextuais
            </p>
        </div>

        <!-- Status do Sistema -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <h3 class="text-xl font-semibold mb-4 text-gray-800">üìä Status do Sistema</h3>
            <div id="system-status" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-700 mb-2">ContextualNotifications</h4>
                    <div id="contextual-status" class="text-sm text-gray-600">
                        Verificando...
                    </div>
                </div>
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-700 mb-2">NotificationIntegrations</h4>
                    <div id="integration-status" class="text-sm text-gray-600">
                        Verificando...
                    </div>
                </div>
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-700 mb-2">App Integration</h4>
                    <div id="app-status" class="text-sm text-gray-600">
                        Verificando...
                    </div>
                </div>
            </div>
        </div>

        <!-- Testes de Notifica√ß√£o -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4 text-blue-800">üîî Testes de Notifica√ß√£o</h3>
                <div class="space-y-3">
                    <button onclick="testWelcomeMessage()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Mensagem de Boas-vindas
                    </button>
                    <button onclick="testSessionComplete()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Sess√£o Completa
                    </button>
                    <button onclick="testAchievement()" class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Conquista
                    </button>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4 text-orange-800">üéØ Testes Contextuais</h3>
                <div class="space-y-3">
                    <button onclick="testMotivational()" class="w-full bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Motivacional
                    </button>
                    <button onclick="testReminder()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Lembrete
                    </button>
                    <button onclick="testCelebration()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Celebra√ß√£o
                    </button>
                </div>
            </div>
        </div>

        <!-- Teste Direto da Fun√ß√£o -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <h3 class="text-xl font-semibold mb-4 text-green-800">üß™ Teste Direto da Fun√ß√£o</h3>
            <div class="space-y-3">
                <button onclick="testDirectToast()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                    Teste Direto showContextualToast
                </button>
                <button onclick="testToastContainer()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                    Teste Cria√ß√£o Container
                </button>
            </div>
        </div>

        <!-- Log de Eventos -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-xl font-semibold mb-4 text-gray-800">üìù Log de Eventos</h3>
            <div id="event-log" class="bg-gray-50 rounded-lg p-4 h-64 overflow-y-auto text-sm font-mono">
                <div class="text-gray-500">Aguardando eventos...</div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Simular ambiente da aplica√ß√£o
        window.app = {
            config: {
                notifications: {
                    enabled: true,
                    maxPerDay: 6,
                    cooldown: 300000,
                    showWelcome: true
                }
            },
            state: {
                activePlanId: 'test-plan'
            },
            showToast: function(message, type) {
                logEvent(`App.showToast: ${message} (${type})`);
            }
        };

        // Fun√ß√£o de log
        function logEvent(message) {
            const log = document.getElementById('event-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = 'text-gray-700 mb-1';
            logEntry.textContent = `[${timestamp}] ${message}`;
            log.appendChild(logEntry);
            log.scrollTop = log.scrollHeight;
        }

        // Verificar status do sistema
        function checkSystemStatus() {
            const contextualStatus = document.getElementById('contextual-status');
            const integrationStatus = document.getElementById('integration-status');
            const appStatus = document.getElementById('app-status');

            // Verificar ContextualNotifications
            if (window.ContextualNotifications) {
                contextualStatus.innerHTML = '<span class="text-green-600">‚úÖ Carregado</span>';
                logEvent('ContextualNotifications: M√≥dulo carregado');
            } else {
                contextualStatus.innerHTML = '<span class="text-red-600">‚ùå N√£o carregado</span>';
                logEvent('ContextualNotifications: M√≥dulo n√£o encontrado');
            }

            // Verificar NotificationIntegrations
            if (window.NotificationIntegrations) {
                integrationStatus.innerHTML = '<span class="text-green-600">‚úÖ Carregado</span>';
                logEvent('NotificationIntegrations: M√≥dulo carregado');
            } else {
                integrationStatus.innerHTML = '<span class="text-red-600">‚ùå N√£o carregado</span>';
                logEvent('NotificationIntegrations: M√≥dulo n√£o encontrado');
            }

            // Verificar App
            if (window.app) {
                appStatus.innerHTML = '<span class="text-green-600">‚úÖ Configurado</span>';
                logEvent('App: Configura√ß√£o carregada');
            } else {
                appStatus.innerHTML = '<span class="text-red-600">‚ùå N√£o configurado</span>';
                logEvent('App: Configura√ß√£o n√£o encontrada');
            }
        }

        // Testes de notifica√ß√£o
        function testWelcomeMessage() {
            logEvent('Teste: Mensagem de boas-vindas');
            if (window.ContextualNotifications) {
                window.ContextualNotifications.showWelcomeMessage();
            } else {
                logEvent('ERRO: ContextualNotifications n√£o dispon√≠vel');
            }
        }

        function testSessionComplete() {
            logEvent('Teste: Sess√£o completa');
            if (window.ContextualNotifications) {
                window.ContextualNotifications.showSessionCompletionMessage('pomodoro', 25, 'Portugu√™s', 'm√©dio');
            } else {
                logEvent('ERRO: ContextualNotifications n√£o dispon√≠vel');
            }
        }

        function testAchievement() {
            logEvent('Teste: Conquista');
            if (window.ContextualNotifications) {
                window.ContextualNotifications.showAchievementMessage({
                    title: 'Primeira Sess√£o',
                    description: 'Completou sua primeira sess√£o de estudo!',
                    xp: 50
                });
            } else {
                logEvent('ERRO: ContextualNotifications n√£o dispon√≠vel');
            }
        }

        function testMotivational() {
            logEvent('Teste: Notifica√ß√£o motivacional');
            if (window.ContextualNotifications) {
                window.ContextualNotifications.showContextualToast({
                    type: 'motivational',
                    title: 'üí™ Motiva√ß√£o',
                    message: 'Voc√™ est√° fazendo um excelente progresso! Continue assim!',
                    duration: 5000
                });
            } else {
                logEvent('ERRO: ContextualNotifications n√£o dispon√≠vel');
            }
        }

        function testReminder() {
            logEvent('Teste: Lembrete');
            if (window.ContextualNotifications) {
                window.ContextualNotifications.showContextualToast({
                    type: 'reminder',
                    title: '‚è∞ Lembrete',
                    message: 'Que tal fazer uma pausa e alongar um pouco?',
                    duration: 5000
                });
            } else {
                logEvent('ERRO: ContextualNotifications n√£o dispon√≠vel');
            }
        }

        function testCelebration() {
            logEvent('Teste: Celebra√ß√£o');
            if (window.ContextualNotifications) {
                window.ContextualNotifications.showContextualToast({
                    type: 'celebration',
                    title: 'üéâ Parab√©ns!',
                    message: 'Voc√™ completou 7 dias consecutivos de estudo!',
                    duration: 5000
                });
            } else {
                logEvent('ERRO: ContextualNotifications n√£o dispon√≠vel');
            }
        }

        // Teste direto da fun√ß√£o
        function testDirectToast() {
            logEvent('Teste: Fun√ß√£o showContextualToast direta');
            if (window.ContextualNotifications && window.ContextualNotifications.showContextualToast) {
                try {
                    window.ContextualNotifications.showContextualToast({
                        type: 'info',
                        title: 'üß™ Teste Direto',
                        message: 'Esta √© um teste direto da fun√ß√£o showContextualToast!',
                        duration: 3000
                    });
                    logEvent('‚úÖ Teste direto executado com sucesso');
                } catch (error) {
                    logEvent(`‚ùå Erro no teste direto: ${error.message}`);
                }
            } else {
                logEvent('‚ùå Fun√ß√£o showContextualToast n√£o dispon√≠vel');
            }
        }

        function testToastContainer() {
            logEvent('Teste: Cria√ß√£o do container de toast');
            if (window.ContextualNotifications && window.ContextualNotifications.createToastContainer) {
                try {
                    const container = window.ContextualNotifications.createToastContainer();
                    logEvent(`‚úÖ Container criado: ${container.id}`);
                } catch (error) {
                    logEvent(`‚ùå Erro ao criar container: ${error.message}`);
                }
            } else {
                logEvent('‚ùå Fun√ß√£o createToastContainer n√£o dispon√≠vel');
            }
        }

        // Carregar m√≥dulos
        async function loadModules() {
            try {
                // Carregar ContextualNotifications
                const contextualModule = await import('./js/modules/contextual-notifications.js');
                if (contextualModule.ContextualNotifications) {
                    window.ContextualNotifications = contextualModule.ContextualNotifications;
                    logEvent('ContextualNotifications: M√≥dulo importado com sucesso');
                }

                // Carregar NotificationIntegrations
                const integrationModule = await import('./js/modules/notification-integrations.js');
                if (integrationModule.NotificationIntegrations) {
                    window.NotificationIntegrations = integrationModule.NotificationIntegrations;
                    logEvent('NotificationIntegrations: M√≥dulo importado com sucesso');
                }

                // Inicializar se dispon√≠vel
                if (window.ContextualNotifications) {
                    await window.ContextualNotifications.init();
                    logEvent('ContextualNotifications: Inicializado');
                }

                if (window.NotificationIntegrations) {
                    await window.NotificationIntegrations.init();
                    logEvent('NotificationIntegrations: Inicializado');
                }

            } catch (error) {
                logEvent(`ERRO ao carregar m√≥dulos: ${error.message}`);
            }

            checkSystemStatus();
        }

        // Inicializar quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', () => {
            logEvent('P√°gina carregada - Iniciando testes...');
            loadModules();
        });
    </script>
</body>
</html>
