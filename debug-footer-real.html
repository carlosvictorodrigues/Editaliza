<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEBUG FOOTER REAL</title>
    <link href="css/footer.css" rel="stylesheet">
    <style>
        body { 
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            margin: 0;
            font-family: Arial, sans-serif;
        }
        main {
            flex: 1;
            padding: 20px;
            background: #f0f0f0;
        }
        .debug-log {
            background: #000;
            color: #0f0;
            padding: 10px;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
            margin: 10px 0;
            border-radius: 5px;
        }
        .error { color: #ff0000; }
        .success { color: #00ff00; }
        .warning { color: #ffff00; }
        .info { color: #00ffff; }
    </style>
</head>
<body>
    <main>
        <h1>üîç DEBUG FOOTER MODULAR</h1>
        
        <div>
            <button onclick="testFooterFiles()">1. Testar Arquivos</button>
            <button onclick="testFooterClass()">2. Testar Classe</button>
            <button onclick="forceInitFooter()">3. For√ßar Init</button>
            <button onclick="checkDOM()">4. Verificar DOM</button>
            <button onclick="clearLog()">Limpar Log</button>
        </div>
        
        <div id="debug-log" class="debug-log">
            <div class="info">üöÄ Iniciando debug do sistema modular...</div>
        </div>
        
        <div>
            <h3>Status dos Arquivos:</h3>
            <div id="file-status">Verificando...</div>
        </div>
        
        <div>
            <h3>Console do Footer:</h3>
            <div id="footer-console" class="debug-log" style="height: 200px;"></div>
        </div>
    </main>

    <!-- FOOTER SER√Å CARREGADO AQUI -->
    <script src="js/footer.js"></script>
    
    <script>
        let logCount = 0;
        
        function log(message, type = 'info') {
            const logDiv = document.getElementById('debug-log');
            const timestamp = new Date().toLocaleTimeString();
            logCount++;
            
            const line = document.createElement('div');
            line.className = type;
            line.innerHTML = `[${timestamp}] ${logCount}: ${message}`;
            logDiv.appendChild(line);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('debug-log').innerHTML = '';
            document.getElementById('footer-console').innerHTML = '';
            logCount = 0;
        }
        
        // Interceptar console do footer
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;
        
        function footerConsoleLog(message, type = 'info') {
            const consoleDiv = document.getElementById('footer-console');
            const timestamp = new Date().toLocaleTimeString();
            
            const line = document.createElement('div');
            line.className = type;
            line.innerHTML = `[${timestamp}] ${message}`;
            consoleDiv.appendChild(line);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            const message = args.join(' ');
            if (message.includes('FOOTER') || message.includes('footer') || message.includes('Footer')) {
                footerConsoleLog(message, 'info');
            }
            originalConsoleLog.apply(console, args);
        };
        
        console.error = function(...args) {
            const message = args.join(' ');
            if (message.includes('FOOTER') || message.includes('footer') || message.includes('Footer')) {
                footerConsoleLog(message, 'error');
            }
            originalConsoleError.apply(console, args);
        };
        
        console.warn = function(...args) {
            const message = args.join(' ');
            if (message.includes('FOOTER') || message.includes('footer') || message.includes('Footer')) {
                footerConsoleLog(message, 'warning');
            }
            originalConsoleWarn.apply(console, args);
        };
        
        async function testFooterFiles() {
            log('üîç Testando arquivos do footer...', 'info');
            
            // Testar footer.css
            try {
                const cssResponse = await fetch('css/footer.css');
                if (cssResponse.ok) {
                    log('‚úÖ css/footer.css - OK', 'success');
                } else {
                    log(`‚ùå css/footer.css - ERRO ${cssResponse.status}`, 'error');
                }
            } catch (e) {
                log(`‚ùå css/footer.css - ERRO: ${e.message}`, 'error');
            }
            
            // Testar components/footer.html
            try {
                const htmlResponse = await fetch('components/footer.html');
                if (htmlResponse.ok) {
                    const htmlContent = await htmlResponse.text();
                    log(`‚úÖ components/footer.html - OK (${htmlContent.length} chars)`, 'success');
                } else {
                    log(`‚ùå components/footer.html - ERRO ${htmlResponse.status}`, 'error');
                }
            } catch (e) {
                log(`‚ùå components/footer.html - ERRO: ${e.message}`, 'error');
            }
            
            // Testar js/footer.js
            log(`‚úÖ js/footer.js - ${typeof window.EditalizaFooter !== 'undefined' ? 'Classe carregada' : 'Classe N√ÉO carregada'}`, 
                typeof window.EditalizaFooter !== 'undefined' ? 'success' : 'error');
        }
        
        function testFooterClass() {
            log('üîç Testando classe EditalizaFooter...', 'info');
            
            if (typeof window.EditalizaFooter === 'undefined') {
                log('‚ùå Classe EditalizaFooter n√£o existe!', 'error');
                return;
            }
            
            log('‚úÖ Classe EditalizaFooter encontrada', 'success');
            
            // Testar inst√¢ncia
            try {
                const footer = new window.EditalizaFooter();
                log('‚úÖ Inst√¢ncia criada com sucesso', 'success');
                log(`üìã Config: useFallback=${footer.config.useFallback}, protocol=${window.location.protocol}`, 'info');
                
                // Testar m√©todos
                log(`‚úÖ M√©todo init: ${typeof footer.init}`, footer.init ? 'success' : 'error');
                log(`‚úÖ M√©todo loadDirectFooter: ${typeof footer.loadDirectFooter}`, footer.loadDirectFooter ? 'success' : 'error');
                
            } catch (e) {
                log(`‚ùå Erro ao criar inst√¢ncia: ${e.message}`, 'error');
            }
        }
        
        async function forceInitFooter() {
            log('üöÄ For√ßando inicializa√ß√£o do footer...', 'info');
            
            if (typeof window.EditalizaFooter === 'undefined') {
                log('‚ùå Classe EditalizaFooter n√£o dispon√≠vel!', 'error');
                return;
            }
            
            try {
                // Remover footer existente se houver
                const existingFooter = document.querySelector('.editaliza-footer');
                if (existingFooter) {
                    existingFooter.remove();
                    log('üóëÔ∏è Footer existente removido', 'warning');
                }
                
                // Criar nova inst√¢ncia
                const footer = new window.EditalizaFooter();
                log('‚úÖ Nova inst√¢ncia criada', 'success');
                
                // For√ßar carregamento direto
                await footer.init({ useFallback: true });
                log('‚úÖ Init chamado com fallback=true', 'success');
                
                // Verificar se apareceu
                setTimeout(() => {
                    const newFooter = document.querySelector('.editaliza-footer');
                    if (newFooter) {
                        log(`‚úÖ SUCESSO! Footer inserido no DOM (altura: ${newFooter.offsetHeight}px)`, 'success');
                    } else {
                        log('‚ùå Footer ainda n√£o apareceu no DOM', 'error');
                    }
                }, 1000);
                
            } catch (e) {
                log(`‚ùå Erro na inicializa√ß√£o for√ßada: ${e.message}`, 'error');
                console.error('Erro detalhado:', e);
            }
        }
        
        function checkDOM() {
            log('üîç Verificando estado do DOM...', 'info');
            
            const footer = document.querySelector('.editaliza-footer');
            const footerContainer = document.querySelector('.footer-container');
            const footerGrid = document.querySelector('.footer-grid');
            
            log(`üìã Footer (.editaliza-footer): ${footer ? '‚úÖ Existe' : '‚ùå N√£o existe'}`, footer ? 'success' : 'error');
            log(`üìã Container (.footer-container): ${footerContainer ? '‚úÖ Existe' : '‚ùå N√£o existe'}`, footerContainer ? 'success' : 'error');
            log(`üìã Grid (.footer-grid): ${footerGrid ? '‚úÖ Existe' : '‚ùå N√£o existe'}`, footerGrid ? 'success' : 'error');
            
            if (footer) {
                log(`üìè Dimens√µes: ${footer.offsetWidth}x${footer.offsetHeight}px`, 'info');
                log(`üëÅÔ∏è Vis√≠vel: ${footer.offsetHeight > 0 ? 'SIM' : 'N√ÉO'}`, footer.offsetHeight > 0 ? 'success' : 'error');
                log(`üé® Display: ${window.getComputedStyle(footer).display}`, 'info');
                log(`üìç Position: ${window.getComputedStyle(footer).position}`, 'info');
            }
            
            // Verificar vari√°veis globais
            log(`üåê window.footerManager: ${window.footerManager ? '‚úÖ Existe' : '‚ùå N√£o existe'}`, window.footerManager ? 'success' : 'error');
            log(`üåê window.loadEditalizaFooter: ${window.loadEditalizaFooter ? '‚úÖ Existe' : '‚ùå N√£o existe'}`, window.loadEditalizaFooter ? 'success' : 'error');
            
            // Verificar protocolo
            log(`üîó Protocolo: ${window.location.protocol}`, 'info');
            log(`üìÅ Local: ${window.location.href}`, 'info');
        }
        
        // Auto-verifica√ß√µes
        document.addEventListener('DOMContentLoaded', () => {
            log('üìÑ DOMContentLoaded disparado', 'info');
            setTimeout(checkDOM, 2000);
        });
        
        window.addEventListener('load', () => {
            log('üåç Window load disparado', 'info');
            setTimeout(checkDOM, 3000);
        });
        
        // Escutar evento do footer
        document.addEventListener('footerLoaded', (e) => {
            log('üéâ Evento footerLoaded recebido!', 'success');
            log(`üìã Detalhes: ${JSON.stringify(e.detail)}`, 'info');
        });
        
        // Status inicial
        setTimeout(() => {
            const statusDiv = document.getElementById('file-status');
            statusDiv.innerHTML = `
                <div>CSS: ${document.querySelector('link[href*="footer.css"]') ? '‚úÖ' : '‚ùå'}</div>
                <div>JS: ${typeof window.EditalizaFooter !== 'undefined' ? '‚úÖ' : '‚ùå'}</div>
                <div>Manager: ${window.footerManager ? '‚úÖ' : '‚ùå'}</div>
                <div>DOM Ready: ${document.readyState}</div>
            `;
        }, 500);
    </script>
</body>
</html>