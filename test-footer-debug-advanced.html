<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Avan√ßado do Footer - Editaliza</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .content {
            flex: 1;
            background: #f0f0f0;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .debug-section {
            background: #e0e0e0;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
        .log-output {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 11px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: black; }
        .btn-danger { background: #dc3545; color: white; }
    </style>
</head>
<body>
    <div class="content">
        <h1>üî¨ Debug Avan√ßado do Footer</h1>
        <p>Esta p√°gina testa e debuga o sistema modular de footer em detalhes.</p>
        
        <div class="debug-section">
            <h3>üéØ Status dos Componentes:</h3>
            <p>CSS carregado: <span id="css-status">Verificando...</span></p>
            <p>Script carregado: <span id="script-status">Verificando...</span></p>
            <p>Footer renderizado: <span id="footer-status">Verificando...</span></p>
            <p>Debug mode ativo: <span id="debug-status">Verificando...</span></p>
        </div>
        
        <div class="debug-section">
            <h3>üîß Controles de Teste:</h3>
            <div class="button-group">
                <button class="btn btn-primary" onclick="forceFooterLoad()">For√ßar Carregamento</button>
                <button class="btn btn-success" onclick="checkFooterStatus()">Verificar Status</button>
                <button class="btn btn-warning" onclick="toggleDebugMode()">Alternar Debug</button>
                <button class="btn btn-danger" onclick="clearLogs()">Limpar Logs</button>
            </div>
        </div>
        
        <div class="debug-section">
            <h3>üìã Informa√ß√µes do Sistema:</h3>
            <div id="system-info">Carregando...</div>
        </div>
        
        <div class="debug-section">
            <h3>üìù Logs em Tempo Real:</h3>
            <div id="log-output" class="log-output">Iniciando logs...</div>
        </div>
    </div>
    
    <!-- Script do rodap√© modular -->
    <script src="js/footer.js"></script>
    
    <script>
        let logOutput = '';
        
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            logOutput += logEntry;
            document.getElementById('log-output').textContent = logOutput;
            
            // Scroll para o final
            const logElement = document.getElementById('log-output');
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        function clearLogs() {
            logOutput = '';
            document.getElementById('log-output').textContent = 'Logs limpos...';
        }
        
        function forceFooterLoad() {
            addLog('üîÑ For√ßando carregamento do footer...', 'action');
            
            if (typeof window.loadFooterRefatorado === 'function') {
                addLog('‚úÖ Fun√ß√£o loadFooterRefatorado encontrada', 'success');
                window.loadFooterRefatorado().then(() => {
                    addLog('üéâ Footer carregado com sucesso via fun√ß√£o for√ßada', 'success');
                    checkFooterStatus();
                }).catch(error => {
                    addLog(`‚ùå Erro ao for√ßar carregamento: ${error.message}`, 'error');
                });
            } else {
                addLog('‚ùå Fun√ß√£o loadFooterRefatorado n√£o encontrada', 'error');
                
                // Tentar criar nova inst√¢ncia
                if (typeof EditalizaFooterRefatorado !== 'undefined') {
                    addLog('üîß Criando nova inst√¢ncia do footer...', 'info');
                    try {
                        const newFooter = new EditalizaFooterRefatorado();
                        newFooter.init().then(() => {
                            addLog('‚úÖ Nova inst√¢ncia criada e inicializada', 'success');
                            checkFooterStatus();
                        }).catch(error => {
                            addLog(`‚ùå Erro na nova inst√¢ncia: ${error.message}`, 'error');
                        });
                    } catch (error) {
                        addLog(`‚ùå Erro ao criar inst√¢ncia: ${error.message}`, 'error');
                    }
                } else {
                    addLog('‚ùå Classe EditalizaFooterRefatorado n√£o encontrada', 'error');
                }
            }
        }
        
        function checkFooterStatus() {
            addLog('üîç Verificando status do footer...', 'action');
            
            // Verificar se existe no DOM
            const footer = document.querySelector('.editaliza-footer-refatorado');
            if (footer) {
                addLog('‚úÖ Footer encontrado no DOM', 'success');
                addLog(`üìç Altura: ${footer.offsetHeight}px`, 'info');
                addLog(`üìç Largura: ${footer.offsetWidth}px`, 'info');
                addLog(`üìç Posi√ß√£o: ${JSON.stringify(footer.getBoundingClientRect())}`, 'info');
                addLog(`üìç Classes: ${footer.className}`, 'info');
                addLog(`üìç Vis√≠vel: ${footer.offsetHeight > 0 && footer.offsetWidth > 0}`, 'info');
                
                // Verificar se est√° vis√≠vel na viewport
                const rect = footer.getBoundingClientRect();
                const isInViewport = rect.top < window.innerHeight && rect.bottom > 0;
                addLog(`üìç Na viewport: ${isInViewport}`, 'info');
                
            } else {
                addLog('‚ùå Footer N√ÉO encontrado no DOM', 'error');
            }
            
            // Verificar se o FooterManager existe
            if (window.footerManagerRefatorado) {
                addLog('‚úÖ FooterManager encontrado', 'success');
                addLog(`üìç Status: ${window.footerManagerRefatorado.isLoaded ? 'Carregado' : 'N√£o carregado'}`, 'info');
                addLog(`üìç Debug mode: ${window.footerManagerRefatorado.debugMode}`, 'info');
            } else {
                addLog('‚ùå FooterManager n√£o encontrado', 'error');
            }
            
            // Verificar se a classe existe
            if (typeof EditalizaFooterRefatorado !== 'undefined') {
                addLog('‚úÖ Classe EditalizaFooterRefatorado dispon√≠vel', 'success');
            } else {
                addLog('‚ùå Classe EditalizaFooterRefatorado n√£o encontrada', 'error');
            }
        }
        
        function toggleDebugMode() {
            if (window.footerManagerRefatorado) {
                window.footerManagerRefatorado.debugMode = !window.footerManagerRefatorado.debugMode;
                addLog(`üîß Debug mode alternado para: ${window.footerManagerRefatorado.debugMode}`, 'action');
            } else {
                addLog('‚ùå FooterManager n√£o dispon√≠vel para alternar debug', 'error');
            }
        }
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            addLog('üöÄ DOM carregado - iniciando debug avan√ßado', 'info');
            
            // Verificar CSS
            const cssStatus = document.getElementById('css-status');
            const footerCSS = document.querySelector('link[href="css/footer.css"]');
            if (footerCSS) {
                cssStatus.textContent = '‚úÖ CSS carregado';
                cssStatus.style.color = 'green';
                addLog('‚úÖ CSS do footer encontrado', 'success');
            } else {
                cssStatus.textContent = '‚ùå CSS n√£o encontrado';
                cssStatus.style.color = 'red';
                addLog('‚ùå CSS do footer n√£o encontrado', 'error');
            }
            
            // Verificar Script
            const scriptStatus = document.getElementById('script-status');
            if (typeof EditalizaFooterRefatorado !== 'undefined') {
                scriptStatus.textContent = '‚úÖ Script carregado';
                scriptStatus.style.color = 'green';
                addLog('‚úÖ Script do footer carregado', 'success');
            } else {
                scriptStatus.textContent = '‚ùå Script n√£o encontrado';
                scriptStatus.style.color = 'red';
                addLog('‚ùå Script do footer n√£o encontrado', 'error');
            }
            
            // Verificar Footer
            setTimeout(() => {
                const footer = document.querySelector('.editaliza-footer-refatorado');
                const footerStatus = document.getElementById('footer-status');
                if (footer) {
                    footerStatus.textContent = '‚úÖ Footer renderizado';
                    footerStatus.style.color = 'green';
                    addLog('‚úÖ Footer renderizado automaticamente', 'success');
                } else {
                    footerStatus.textContent = '‚ùå Footer n√£o renderizado';
                    footerStatus.style.color = 'red';
                    addLog('‚ùå Footer n√£o foi renderizado automaticamente', 'error');
                }
            }, 2000);
            
            // Verificar Debug Mode
            setTimeout(() => {
                const debugStatus = document.getElementById('debug-status');
                if (window.footerManagerRefatorado) {
                    debugStatus.textContent = window.footerManagerRefatorado.debugMode ? '‚úÖ Ativo' : '‚ùå Inativo';
                    debugStatus.style.color = window.footerManagerRefatorado.debugMode ? 'green' : 'red';
                    addLog(`üîß Debug mode: ${window.footerManagerRefatorado.debugMode ? 'Ativo' : 'Inativo'}`, 'info');
                } else {
                    debugStatus.textContent = '‚ùå N√£o dispon√≠vel';
                    debugStatus.style.color = 'red';
                    addLog('‚ùå FooterManager n√£o dispon√≠vel para verificar debug mode', 'error');
                }
            }, 1000);
            
            // Informa√ß√µes do sistema
            const systemInfo = document.getElementById('system-info');
            systemInfo.innerHTML = `
                <strong>URL:</strong> ${window.location.href}<br>
                <strong>Protocolo:</strong> ${window.location.protocol}<br>
                <strong>User Agent:</strong> ${navigator.userAgent}<br>
                <strong>Timestamp:</strong> ${new Date().toLocaleString()}<br>
                <strong>EditalizaFooterRefatorado:</strong> ${typeof EditalizaFooterRefatorado}<br>
                <strong>footerManagerRefatorado:</strong> ${typeof window.footerManagerRefatorado !== 'undefined' ? 'Dispon√≠vel' : 'N√£o dispon√≠vel'}
            `;
        });
        
        // Monitorar eventos do footer
        document.addEventListener('footerRefatoradoLoaded', function(event) {
            addLog('üéâ Evento footerRefatoradoLoaded recebido!', 'success');
            addLog(`üìç Detalhes: ${JSON.stringify(event.detail)}`, 'info');
        });
        
        // Logs iniciais
        addLog('üîç Debug avan√ßado iniciado', 'info');
        addLog(`üìÅ Arquivo: ${window.location.pathname}`, 'info');
        addLog(`üîß EditalizaFooterRefatorado: ${typeof EditalizaFooterRefatorado}`, 'info');
        
        // Verificar se h√° erros
        window.addEventListener('error', function(e) {
            addLog(`‚ùå Erro capturado: ${e.error}`, 'error');
        });
        
        // Logs do console interceptados
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.log = function(...args) {
            if (args[0] && typeof args[0] === 'string' && args[0].includes('FooterRefatorado')) {
                addLog(`Console: ${args.join(' ')}`, 'console');
            }
            originalLog.apply(console, args);
        };
        
        console.error = function(...args) {
            if (args[0] && typeof args[0] === 'string' && args[0].includes('FooterRefatorado')) {
                addLog(`Console Error: ${args.join(' ')}`, 'console-error');
            }
            originalError.apply(console, args);
        };
        
        console.warn = function(...args) {
            if (args[0] && typeof args[0] === 'string' && args[0].includes('FooterRefatorado')) {
                addLog(`Console Warn: ${args.join(' ')}`, 'console-warn');
            }
            originalWarn.apply(console, args);
        };
    </script>
</body>
</html>
